<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ERC-8004 Autonomous Trading Agent — Live Demo</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: #0d0d0d;
      color: #e0e0e0;
      font-family: 'Courier New', 'Lucida Console', monospace;
      padding: 24px;
      max-width: 980px;
      margin: 0 auto;
    }
    h1 {
      color: #00ff88;
      text-align: center;
      font-size: 1.9em;
      margin-bottom: 6px;
      letter-spacing: 0.04em;
    }
    .subtitle {
      text-align: center;
      color: #888;
      font-size: 0.88em;
      margin-bottom: 10px;
    }
    .banner {
      text-align: center;
      background: linear-gradient(135deg, #0a2a1a, #0a1a2a);
      border: 1px solid #00ff8844;
      border-radius: 8px;
      padding: 14px 20px;
      margin-bottom: 28px;
      font-size: 0.93em;
      letter-spacing: 0.03em;
    }
    .banner .stat { color: #00ff88; font-weight: bold; font-size: 1.1em; }
    .banner .sep { color: #334; margin: 0 10px; }
    .run-all-row {
      text-align: center;
      margin-bottom: 28px;
    }
    .btn-run-all {
      background: #00ff88;
      color: #000;
      border: none;
      border-radius: 6px;
      padding: 10px 28px;
      font-family: 'Courier New', monospace;
      font-size: 1em;
      font-weight: bold;
      cursor: pointer;
      letter-spacing: 0.04em;
      transition: background 0.2s, transform 0.1s;
    }
    .btn-run-all:hover { background: #00cc6a; transform: scale(1.03); }
    .btn-run-all:active { transform: scale(0.97); }
    .section {
      background: #141414;
      border: 1px solid #2a2a2a;
      border-radius: 10px;
      padding: 22px;
      margin: 18px 0;
      transition: border-color 0.2s;
    }
    .section:hover { border-color: #00aaff33; }
    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 10px;
      flex-wrap: wrap;
      gap: 8px;
    }
    .section-title {
      color: #00aaff;
      font-size: 1.1em;
      font-weight: bold;
    }
    .section-num {
      color: #444;
      margin-right: 8px;
    }
    .method-tag {
      font-size: 0.75em;
      padding: 2px 7px;
      border-radius: 3px;
      font-weight: bold;
      margin-right: 6px;
    }
    .get { background: #1a3a1a; color: #00ff88; border: 1px solid #00ff8844; }
    .post { background: #1a1a3a; color: #88aaff; border: 1px solid #88aaff44; }
    .endpoint-url {
      color: #ffaa00;
      font-size: 0.82em;
      font-family: 'Courier New', monospace;
    }
    .btn-run {
      background: transparent;
      color: #00ff88;
      border: 1px solid #00ff8866;
      border-radius: 5px;
      padding: 5px 16px;
      font-family: 'Courier New', monospace;
      font-size: 0.85em;
      cursor: pointer;
      transition: background 0.15s, border-color 0.15s;
      white-space: nowrap;
    }
    .btn-run:hover { background: #00ff8818; border-color: #00ff88; }
    .btn-run:disabled { opacity: 0.5; cursor: not-allowed; }
    .curl-block {
      background: #0a0a0a;
      border: 1px solid #1e1e1e;
      border-radius: 5px;
      padding: 9px 14px;
      font-size: 0.78em;
      color: #666;
      margin: 8px 0;
      overflow-x: auto;
      white-space: pre;
    }
    .curl-label { color: #444; font-size: 0.75em; margin-bottom: 3px; }
    .result-area {
      background: #0a0a0a;
      border: 1px solid #1e2e1e;
      border-radius: 6px;
      padding: 14px;
      font-size: 0.8em;
      color: #00ff88;
      white-space: pre-wrap;
      word-wrap: break-word;
      min-height: 52px;
      max-height: 420px;
      overflow-y: auto;
      margin-top: 10px;
      transition: border-color 0.2s;
    }
    .result-area.loading { color: #888; border-color: #ffaa0044; }
    .result-area.error { color: #ff6666; border-color: #ff444444; }
    .result-area.success { border-color: #00ff8844; }
    .result-area.empty { color: #444; font-style: italic; }
    .status-badge {
      display: inline-block;
      font-size: 0.72em;
      padding: 2px 8px;
      border-radius: 3px;
      margin-left: 8px;
      vertical-align: middle;
    }
    .badge-ok { background: #0a2a0a; color: #00ff88; border: 1px solid #00ff8833; }
    .badge-err { background: #2a0a0a; color: #ff6666; border: 1px solid #ff444433; }
    .badge-run { background: #2a2a0a; color: #ffaa00; border: 1px solid #ffaa0033; }
    .quickstart {
      background: #0d1a0d;
      border: 1px solid #1e3a1e;
      border-radius: 8px;
      padding: 18px;
      margin: 22px 0;
    }
    .quickstart h2 { color: #00ff88; margin-bottom: 10px; font-size: 0.92em; text-transform: uppercase; letter-spacing: 0.08em; }
    .quickstart pre { color: #aaffaa; background: #080808; padding: 12px; border-radius: 4px; font-size: 0.8em; overflow-x: auto; }
    .footer {
      text-align: center;
      color: #444;
      font-size: 0.78em;
      margin-top: 40px;
      padding-top: 18px;
      border-top: 1px solid #222;
    }
    .footer a { color: #00aaff; text-decoration: none; }
    .progress-bar {
      height: 3px;
      background: #222;
      border-radius: 2px;
      margin: 8px 0 4px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: #00ff88;
      width: 0;
      transition: width 0.4s;
    }
    @keyframes pulse {
      0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; }
    }
    .pulsing { animation: pulse 1.2s infinite; }
  </style>
</head>
<body>

  <h1>ERC-8004 Autonomous Trading Agent</h1>
  <p class="subtitle">On-Chain Trading Agent Identity Standard — lablab.ai Hackathon 2026</p>

  <div class="banner">
    <span class="stat">6,190</span> Tests Passing
    <span class="sep">|</span>
    <span class="stat">10</span> Agents
    <span class="sep">|</span>
    Swarm Intelligence
    <span class="sep">|</span>
    VaR 95/99% Risk Engine
    <span class="sep">|</span>
    x402 Payment Gate
    <span class="sep">|</span>
    Sprint <span class="stat">S52</span>
  </div>

  <div class="run-all-row">
    <button class="btn-run-all" id="btn-run-all" onclick="runAll()">&#9654; Run All Live Demo Steps</button>
    <span id="run-all-status"></span>
  </div>

  <!-- Section 1: Health -->
  <div class="section" id="sec-health">
    <div class="section-header">
      <div>
        <span class="section-num">1.</span>
        <span class="section-title">Health Check</span>
        <span id="badge-health"></span>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="method-tag get">GET</span>
        <span class="endpoint-url">/demo/health</span>
        <button class="btn-run" id="btn-health" onclick="runSection('health')">&#9654; Run</button>
      </div>
    </div>
    <div class="curl-label">curl equivalent:</div>
    <div class="curl-block">curl https://api.opspawn.com/erc8004/demo/health</div>
    <div class="progress-bar"><div class="progress-fill" id="prog-health"></div></div>
    <div class="result-area empty" id="result-health">// Click Run to fetch live data from the server...</div>
  </div>

  <!-- Section 2: Swarm Vote -->
  <div class="section" id="sec-swarm">
    <div class="section-header">
      <div>
        <span class="section-num">2.</span>
        <span class="section-title">10-Agent Swarm Vote</span>
        <span id="badge-swarm"></span>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="method-tag post">POST</span>
        <span class="endpoint-url">/api/v1/swarm/vote</span>
        <button class="btn-run" id="btn-swarm" onclick="runSection('swarm')">&#9654; Run</button>
      </div>
    </div>
    <div class="curl-label">curl equivalent:</div>
    <div class="curl-block">curl -s -X POST 'https://api.opspawn.com/erc8004/api/v1/swarm/vote' \
  -H 'Content-Type: application/json' \
  -d '{"symbol":"BTC-USD","signal_type":"BUY"}' | python3 -m json.tool</div>
    <div class="progress-bar"><div class="progress-fill" id="prog-swarm"></div></div>
    <div class="result-area empty" id="result-swarm">// Click Run to fetch live data from the server...</div>
  </div>

  <!-- Section 3: Risk Portfolio -->
  <div class="section" id="sec-risk">
    <div class="section-header">
      <div>
        <span class="section-num">3.</span>
        <span class="section-title">Portfolio Risk (var_95, var_99, Sharpe)</span>
        <span id="badge-risk"></span>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="method-tag get">GET</span>
        <span class="endpoint-url">/api/v1/risk/portfolio</span>
        <button class="btn-run" id="btn-risk" onclick="runSection('risk')">&#9654; Run</button>
      </div>
    </div>
    <div class="curl-label">curl equivalent:</div>
    <div class="curl-block">curl https://api.opspawn.com/erc8004/api/v1/risk/portfolio | python3 -m json.tool</div>
    <div class="progress-bar"><div class="progress-fill" id="prog-risk"></div></div>
    <div class="result-area empty" id="result-risk">// Click Run to fetch live data from the server...</div>
  </div>

  <!-- Section 4: Performance -->
  <div class="section" id="sec-perf">
    <div class="section-header">
      <div>
        <span class="section-num">4.</span>
        <span class="section-title">Performance Summary</span>
        <span id="badge-perf"></span>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="method-tag get">GET</span>
        <span class="endpoint-url">/api/v1/performance/summary</span>
        <button class="btn-run" id="btn-perf" onclick="runSection('perf')">&#9654; Run</button>
      </div>
    </div>
    <div class="curl-label">curl equivalent:</div>
    <div class="curl-block">curl https://api.opspawn.com/erc8004/api/v1/performance/summary | python3 -m json.tool</div>
    <div class="progress-bar"><div class="progress-fill" id="prog-perf"></div></div>
    <div class="result-area empty" id="result-perf">// Click Run to fetch live data from the server...</div>
  </div>

  <!-- Section 5: Showcase -->
  <div class="section" id="sec-showcase">
    <div class="section-header">
      <div>
        <span class="section-num">5.</span>
        <span class="section-title">Full Pipeline Showcase</span>
        <span id="badge-showcase"></span>
      </div>
      <div style="display:flex;align-items:center;gap:12px;">
        <span class="method-tag post">POST</span>
        <span class="endpoint-url">/api/v1/demo/showcase</span>
        <button class="btn-run" id="btn-showcase" onclick="runSection('showcase')">&#9654; Run</button>
      </div>
    </div>
    <div class="curl-label">curl equivalent:</div>
    <div class="curl-block">curl -s -X POST 'https://api.opspawn.com/erc8004/api/v1/demo/showcase' | python3 -m json.tool</div>
    <div class="progress-bar"><div class="progress-fill" id="prog-showcase"></div></div>
    <div class="result-area empty" id="result-showcase">// Click Run to fetch live data from the server...</div>
  </div>

  <div class="quickstart">
    <h2>&#9654; Quick Start (run locally)</h2>
    <pre>git clone https://github.com/opspawn/erc8004-trading-agent
pip install -r agent/requirements.txt
python3 agent/demo_server.py --port 8084 &
curl http://localhost:8084/demo/health
# Run all tests:
cd agent && python3 -m pytest tests/ -q --tb=no</pre>
  </div>

  <div class="footer">
    <p>ERC-8004 Autonomous Trading Agent &mdash;
    <a href="https://github.com/opspawn/erc8004-trading-agent">github.com/opspawn/erc8004-trading-agent</a>
    &mdash; Built for lablab.ai ERC-8004 Hackathon 2026 &mdash; Sprint S52</p>
  </div>

<script>
const BASE = "https://api.opspawn.com/erc8004";

const SECTIONS = {
  health:   { method: "GET",  path: "/demo/health",                body: null },
  swarm:    { method: "POST", path: "/api/v1/swarm/vote",          body: { symbol: "BTC-USD", signal_type: "BUY" } },
  risk:     { method: "GET",  path: "/api/v1/risk/portfolio",      body: null },
  perf:     { method: "GET",  path: "/api/v1/performance/summary", body: null },
  showcase: { method: "POST", path: "/api/v1/demo/showcase",       body: {} },
};

function setResult(id, text, state) {
  const el = document.getElementById("result-" + id);
  el.className = "result-area " + (state || "");
  el.textContent = text;
}

function setBadge(id, state) {
  const el = document.getElementById("badge-" + id);
  if (state === "ok") {
    el.innerHTML = '<span class="status-badge badge-ok">&#10003; 200 OK</span>';
  } else if (state === "err") {
    el.innerHTML = '<span class="status-badge badge-err">&#10007; Error</span>';
  } else if (state === "run") {
    el.innerHTML = '<span class="status-badge badge-run pulsing">&#9679; Running...</span>';
  } else {
    el.innerHTML = "";
  }
}

function setProgress(id, pct) {
  const el = document.getElementById("prog-" + id);
  if (el) el.style.width = pct + "%";
}

async function runSection(id) {
  const cfg = SECTIONS[id];
  const btn = document.getElementById("btn-" + id);
  btn.disabled = true;
  setResult(id, "Fetching from " + BASE + cfg.path + " ...", "loading");
  setBadge(id, "run");
  setProgress(id, 30);

  try {
    const opts = {
      method: cfg.method,
      headers: { "Content-Type": "application/json" },
    };
    if (cfg.body !== null) opts.body = JSON.stringify(cfg.body);

    setProgress(id, 60);
    const res = await fetch(BASE + cfg.path, opts);
    setProgress(id, 90);
    const data = await res.json();
    setProgress(id, 100);
    setResult(id, JSON.stringify(data, null, 2), "success");
    setBadge(id, "ok");
  } catch (err) {
    setProgress(id, 100);
    setResult(id, "Error: " + err.message + "\n\nNote: If running locally, update BASE to http://localhost:8084", "error");
    setBadge(id, "err");
  }

  btn.disabled = false;
  setTimeout(() => setProgress(id, 0), 1500);
}

async function runAll() {
  const btn = document.getElementById("btn-run-all");
  const status = document.getElementById("run-all-status");
  btn.disabled = true;
  status.textContent = " Running all 5 steps...";
  const ids = Object.keys(SECTIONS);
  for (let i = 0; i < ids.length; i++) {
    status.textContent = " Step " + (i + 1) + "/" + ids.length + " — " + ids[i] + "...";
    await runSection(ids[i]);
    await new Promise(r => setTimeout(r, 400));
  }
  status.textContent = " Done!";
  btn.disabled = false;
  setTimeout(() => { status.textContent = ""; }, 3000);
}
</script>
</body>
</html>
